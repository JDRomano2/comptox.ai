
<!DOCTYPE html>
<meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0"/>

<head>
  <meta charset="utf-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

  

    <title>Graph &mdash; ComptoxAI 0.1a documentation</title>
  



  <link rel="shortcut icon" href="../_static/favicon.ico"/>



<script src="https://use.fontawesome.com/04f6e4e6fe.js"></script>


<link rel="stylesheet" href="../_static/css/vendor/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="../_static/css/custom.css" type="text/css" /> 
</head>

<!-- see: https://stackoverflow.com/a/27704409/1730417 -->
<body id="bootstrap-overrides">
  <header class="fixed-top">
  <nav class="navbar navbar-expand-md navbar-light">
    <a href="../index.html" class="navbar-brand" id="logo">ComptoxAI</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav mr-auto">
        
        <li class="nav-item"><a href="../about.html" class="nav-link">About</a></li>
        <li class="nav-item"><a href="../install.html" class="nav-link">Install</a></li>
        <li class="nav-item"><a href="../use/index.html" class="nav-link">Guide</a></li>
        <li class="nav-item"><a href="index.html" class="nav-link">API Docs</a></li>
        <li class="nav-item"><a href="../contact.html" class="nav-link">Contact</a></li>
      </ul>
      <span class="navbar-text">
        <a href="https://github.com/jdromano2/comptox_ai" target="_blank"><i class="fa fa-github-square fa-2x"></i></a>
      </span>
    </div>
  </nav>
</header>
    <div class="d-flex" id="page-wrapper">
      <div id="page-content-wrapper">
        <div class="page-content container-fluid body px-md-3" role="main">
          
  <div class="section" id="module-comptox_ai.graph">
<span id="graph"></span><h1>Graph<a class="headerlink" href="#module-comptox_ai.graph" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="comptox_ai.graph.Graph">
<em class="property">class </em><code class="sig-prename descclassname">comptox_ai.graph.</code><code class="sig-name descname">Graph</code><span class="sig-paren">(</span><em class="sig-param">data: comptox_ai.graph.io.GraphDataMixin</em><span class="sig-paren">)</span><a class="headerlink" href="#comptox_ai.graph.Graph" title="Permalink to this definition">¶</a></dt>
<dd><p>A graph representation of ComptoxAI data.</p>
<p>The internal data storage can be in several different formats, each of
which has advantages in different scenarios.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>data</strong><span class="classifier">comptox_ai.graph.io.GraphDataMixin</span></dt><dd><p>A graph data structure that is of one of the formats compliant with
ComptoxAI’s standardized graph API.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>format</strong><span class="classifier">{“graphsage”, “networkx”, “neo4j}</span></dt><dd><p>Internal format of the graph data. The format determines many aspects
of how you interact with the graph, including the set of methods that
can be called on it and the types of models that you can construct
without first converting to another format.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#comptox_ai.graph.Graph.add_edges" title="comptox_ai.graph.Graph.add_edges"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_edges</span></code></a>(self, edges, tuple])</p></td>
<td><p>Add one or more edges to the graph.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#comptox_ai.graph.Graph.add_nodes" title="comptox_ai.graph.Graph.add_nodes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_nodes</span></code></a>(self, nodes, tuple])</p></td>
<td><p>Add one or more nodes to the graph.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#comptox_ai.graph.Graph.convert" title="comptox_ai.graph.Graph.convert"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convert</span></code></a>(self, to_fmt)</p></td>
<td><p>Convert the graph data structure into the specified format.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#comptox_ai.graph.Graph.edges" title="comptox_ai.graph.Graph.edges"><code class="xref py py-obj docutils literal notranslate"><span class="pre">edges</span></code></a>(self)</p></td>
<td><p>Get all edges in the graph and return as an iterable of tuples.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#comptox_ai.graph.Graph.from_dgl" title="comptox_ai.graph.Graph.from_dgl"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_dgl</span></code></a>()</p></td>
<td><p>Create a ComptoxAI graph, populating the contents from a DGL graph (not yet implemented).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#comptox_ai.graph.Graph.from_graphsage" title="comptox_ai.graph.Graph.from_graphsage"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_graphsage</span></code></a>(prefix, directory)</p></td>
<td><p>Create a new GraphSAGE data structure from files formatted according to the examples given in <a class="reference external" href="https://github.com/williamleif/GraphSAGE">https://github.com/williamleif/GraphSAGE</a>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#comptox_ai.graph.Graph.from_neo4j" title="comptox_ai.graph.Graph.from_neo4j"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_neo4j</span></code></a>(config_file)</p></td>
<td><p>Load a connection to a Neo4j graph database and use it to instantiate a comptox_ai.graph.io.Neo4j object.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#comptox_ai.graph.Graph.from_networkx" title="comptox_ai.graph.Graph.from_networkx"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_networkx</span></code></a>()</p></td>
<td><p>Create a new ComptoxAI graph from a JSON node-link graph file, storing the data as a NetworkX graph.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#comptox_ai.graph.Graph.nodes" title="comptox_ai.graph.Graph.nodes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nodes</span></code></a>(self)</p></td>
<td><p>Get all nodes in the graph and return as an iterable of tuples.</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="comptox_ai.graph.Graph.add_edges">
<code class="sig-name descname">add_edges</code><span class="sig-paren">(</span><em class="sig-param">self, edges: Union[List[tuple], tuple]</em><span class="sig-paren">)</span><a class="headerlink" href="#comptox_ai.graph.Graph.add_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Add one or more edges to the graph.</p>
</dd></dl>

<dl class="method">
<dt id="comptox_ai.graph.Graph.add_nodes">
<code class="sig-name descname">add_nodes</code><span class="sig-paren">(</span><em class="sig-param">self, nodes: Union[List[tuple], tuple]</em><span class="sig-paren">)</span><a class="headerlink" href="#comptox_ai.graph.Graph.add_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Add one or more nodes to the graph.</p>
</dd></dl>

<dl class="method">
<dt id="comptox_ai.graph.Graph.convert">
<code class="sig-name descname">convert</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">to_fmt: str</em><span class="sig-paren">)</span><a class="headerlink" href="#comptox_ai.graph.Graph.convert" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the graph data structure into the specified format.</p>
<p>The actual graph contained in a <cite>comptox_ai.Graph</cite> can be in a variety
of different formats. When the user loads a graph</p>
</dd></dl>

<dl class="method">
<dt id="comptox_ai.graph.Graph.edges">
<code class="sig-name descname">edges</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="headerlink" href="#comptox_ai.graph.Graph.edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all edges in the graph and return as an iterable of tuples.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>iterable</dt><dd><p>Iterable over tuples containing graph edge triples.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="comptox_ai.graph.Graph.from_dgl">
<em class="property">classmethod </em><code class="sig-name descname">from_dgl</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#comptox_ai.graph.Graph.from_dgl" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a ComptoxAI graph, populating the contents from a DGL graph (not
yet implemented).</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>NotImplementedError</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="comptox_ai.graph.Graph.from_graphsage">
<em class="property">classmethod </em><code class="sig-name descname">from_graphsage</code><span class="sig-paren">(</span><em class="sig-param">prefix: str</em>, <em class="sig-param">directory: str = None</em><span class="sig-paren">)</span><a class="headerlink" href="#comptox_ai.graph.Graph.from_graphsage" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new GraphSAGE data structure from files formatted according to
the examples given in <a class="reference external" href="https://github.com/williamleif/GraphSAGE">https://github.com/williamleif/GraphSAGE</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>prefix</strong><span class="classifier">str</span></dt><dd><p>The prefix used at the beginning of each file name (see above for
format specification).</p>
</dd>
<dt><strong>directory</strong><span class="classifier">str, default=None</span></dt><dd><p>The directory (fully specified or relative) containing the data
files to load.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#comptox_ai.graph.GraphSAGEData" title="comptox_ai.graph.GraphSAGEData"><code class="xref py py-obj docutils literal notranslate"><span class="pre">comptox_ai.graph.GraphSAGEData</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The parameters should point to files with the following structure:</p>
<dl class="simple">
<dt>{prefix}-G.json</dt><dd><p>JSON file containing a NetworkX ‘node link’ instance of the input
graph. GraphSAGE usually expects there to be ‘val’ and ‘test’
attributes on each node indicating if they are part of the
validation and test sets, but this isn’t enforced by ComptoxAI (at
least not currently).</p>
</dd>
<dt>{prefix}-id_map.json</dt><dd><p>A JSON object that maps graph node ids (integers) to consecutive
integers (0-indexed).</p>
</dd>
<dt>{prefix}-class_map.json (OPTIONAL)</dt><dd><p>A JSON object that maps graph node ids (integers) to a one-hot list
of binary class membership (e.g., {2: [0, 0, 1, 0, 1]} means that
node 2 is a member of classes 3 and 5). NOTE: While this is shown
as a mandatory component of a dataset in GraphSAGE’s documentation,
we don’t enforce that. NOTE: The notion of a class in terms of
GraphSAGE is different than the notion of a class in heterogeneous
network theory. Here, a ‘class’ is a label to be used in a
supervised learning setting (such as classifying chemicals as
likely carcinogens versus likely non-carcinogens).</p>
</dd>
<dt>{prefix}-feats.npy (OPTIONAL)</dt><dd><p>A NumPy ndarray containing numerical node features. NOTE: This
serialization is currently not compatible with heterogeneous
graphs, as GraphSAGE was originally implemented for
nonheterogeneous graphs only.</p>
</dd>
<dt>{prefix}-walks.txt (OPTIONAL)</dt><dd><p>A text file containing precomputed random walks along the graph.
Each line is a pair of node integers (e.g., the second fields in
the id_map file) indicating an edge included in random walks. The
lines should be arranged in ascending order, starting with the 
first item in each pair.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="comptox_ai.graph.Graph.from_neo4j">
<em class="property">classmethod </em><code class="sig-name descname">from_neo4j</code><span class="sig-paren">(</span><em class="sig-param">config_file: str = None</em><span class="sig-paren">)</span><a class="headerlink" href="#comptox_ai.graph.Graph.from_neo4j" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a connection to a Neo4j graph database and use it to
instantiate a comptox_ai.graph.io.Neo4j object.</p>
<p>NOTE: All we do here is create a driver for the graph database; the
Neo4j constructor handles building the node index and other important
attributes. This is different from most of the other formats, where
the attributes are provided by the constructor</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>config_file</strong><span class="classifier">str, default None</span></dt><dd><p>Path to a ComptoxAI configuration file. If None, ComptoxAI will
search for a configuration file in the default location. For more
information, refer to <a class="reference external" href="http://comptox.ai/docs/guide/building.html">http://comptox.ai/docs/guide/building.html</a>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><dl class="simple">
<dt>RuntimeError</dt><dd><p>If the data in the configuration file does not point to a valid
Neo4j graph database.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#comptox_ai.graph.Neo4jData" title="comptox_ai.graph.Neo4jData"><code class="xref py py-obj docutils literal notranslate"><span class="pre">comptox_ai.graph.Neo4jData</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="comptox_ai.graph.Graph.from_networkx">
<em class="property">classmethod </em><code class="sig-name descname">from_networkx</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#comptox_ai.graph.Graph.from_networkx" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new ComptoxAI graph from a JSON node-link graph file, storing
the data as a NetworkX graph.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#comptox_ai.graph.NetworkXData" title="comptox_ai.graph.NetworkXData"><code class="xref py py-obj docutils literal notranslate"><span class="pre">comptox_ai.graph.NetworkXData</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="comptox_ai.graph.Graph.nodes">
<code class="sig-name descname">nodes</code><span class="sig-paren">(</span><em class="sig-param">self</em><span class="sig-paren">)</span><a class="headerlink" href="#comptox_ai.graph.Graph.nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all nodes in the graph and return as an iterable of tuples.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>iterable</dt><dd><p>Iterable over 2-tuples containing graph nodes. The first element is
the node’s integer ID and the second is the URI of that node (if
available).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="comptox_ai.graph.Neo4jData">
<em class="property">class </em><code class="sig-prename descclassname">comptox_ai.graph.</code><code class="sig-name descname">Neo4jData</code><span class="sig-paren">(</span><em class="sig-param">database: py2neo.database.Database</em><span class="sig-paren">)</span><a class="headerlink" href="#comptox_ai.graph.Neo4jData" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal representation of a connection to a Neo4j graph database
containing ComptoxAI data.</p>
<p>Importantly, this data structure does not load the complete contents of the
database into Python’s memory space. This places significantly less demand
on system resources when not executing large queries or performing complex
data manipulations. This representation is also able to unload a fair deal
of logic onto Neo4j’s standard library in implementing various standardized
operations.</p>
<p>The recommended way to instantiate this class is by calling
comptox_ai.Graph.from_neo4j(), which handles establishing a database driver
connection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>driver</strong><span class="classifier">neo4j.Driver</span></dt><dd><p>A driver connected to a Neo4j graph database containing ComptoxAI data.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>edges</strong></dt><dd></dd>
<dt><strong>is_heterogeneous</strong></dt><dd></dd>
<dt><a class="reference internal" href="#comptox_ai.graph.Neo4jData.nodes" title="comptox_ai.graph.Neo4jData.nodes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">nodes</span></code></a></dt><dd><p>Get a list of all nodes corresponding to a named individual in the ComptoxAI ontology.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#comptox_ai.graph.Neo4jData.add_edge" title="comptox_ai.graph.Neo4jData.add_edge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_edge</span></code></a>(self, edge)</p></td>
<td><p>Add an edge to the graph and synchronize it to the remote database.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#comptox_ai.graph.Neo4jData.add_edges" title="comptox_ai.graph.Neo4jData.add_edges"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_edges</span></code></a>(self, edges)</p></td>
<td><p>Add a list of edges to the graph and synchronize them to the remote database.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#comptox_ai.graph.Neo4jData.add_node" title="comptox_ai.graph.Neo4jData.add_node"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_node</span></code></a>(self, node)</p></td>
<td><p>Add a node to the graph and synchronize it to the remote database.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#comptox_ai.graph.Neo4jData.add_nodes" title="comptox_ai.graph.Neo4jData.add_nodes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_nodes</span></code></a>(self, nodes)</p></td>
<td><p>Add a list of nodes to the graph and synchronize them to the remote database.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#comptox_ai.graph.Neo4jData.run_query_in_session" title="comptox_ai.graph.Neo4jData.run_query_in_session"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run_query_in_session</span></code></a>(self, query)</p></td>
<td><p>Submit a cypher query transaction to the connected graph database driver and return the response to the calling function.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 67%" />
<col style="width: 33%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>save_graph</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>standardize_edge</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>standardize_node</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="comptox_ai.graph.Neo4jData.add_edge">
<code class="sig-name descname">add_edge</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">edge: tuple</em><span class="sig-paren">)</span><a class="headerlink" href="#comptox_ai.graph.Neo4jData.add_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an edge to the graph and synchronize it to the remote database.</p>
</dd></dl>

<dl class="method">
<dt id="comptox_ai.graph.Neo4jData.add_edges">
<code class="sig-name descname">add_edges</code><span class="sig-paren">(</span><em class="sig-param">self, edges: List[tuple]</em><span class="sig-paren">)</span><a class="headerlink" href="#comptox_ai.graph.Neo4jData.add_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a list of edges to the graph and synchronize them to the remote
database.</p>
</dd></dl>

<dl class="method">
<dt id="comptox_ai.graph.Neo4jData.add_node">
<code class="sig-name descname">add_node</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">node: tuple</em><span class="sig-paren">)</span><a class="headerlink" href="#comptox_ai.graph.Neo4jData.add_node" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a node to the graph and synchronize it to the remote database.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>node</strong><span class="classifier">tuple of (int, label, <a href="#id1"><span class="problematic" id="id2">**</span></a>props)</span></dt><dd><p>Node to add to the graph.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="comptox_ai.graph.Neo4jData.add_nodes">
<code class="sig-name descname">add_nodes</code><span class="sig-paren">(</span><em class="sig-param">self, nodes: List[tuple]</em><span class="sig-paren">)</span><a class="headerlink" href="#comptox_ai.graph.Neo4jData.add_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a list of nodes to the graph and synchronize them to the remote
database.</p>
</dd></dl>

<dl class="method">
<dt id="comptox_ai.graph.Neo4jData.nodes">
<em class="property">property </em><code class="sig-name descname">nodes</code><a class="headerlink" href="#comptox_ai.graph.Neo4jData.nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a list of all nodes corresponding to a named individual in the
ComptoxAI ontology.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>list of py2neo.Node</dt><dd><p>List of all Neo4j nodes corresponding to a named individual.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="comptox_ai.graph.Neo4jData.run_query_in_session">
<code class="sig-name descname">run_query_in_session</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">query: str</em><span class="sig-paren">)</span><a class="headerlink" href="#comptox_ai.graph.Neo4jData.run_query_in_session" title="Permalink to this definition">¶</a></dt>
<dd><p>Submit a cypher query transaction to the connected graph database
driver and return the response to the calling function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>query</strong><span class="classifier">str</span></dt><dd><p>String representation of the cypher query to be executed.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>list of neo4j.Record</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="comptox_ai.graph.NetworkXData">
<em class="property">class </em><code class="sig-prename descclassname">comptox_ai.graph.</code><code class="sig-name descname">NetworkXData</code><span class="sig-paren">(</span><em class="sig-param">graph: networkx.classes.digraph.DiGraph = None</em><span class="sig-paren">)</span><a class="headerlink" href="#comptox_ai.graph.NetworkXData" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>edges</strong></dt><dd></dd>
<dt><strong>is_heterogeneous</strong></dt><dd></dd>
<dt><strong>nodes</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#comptox_ai.graph.NetworkXData.NetworkxJsonEncoder" title="comptox_ai.graph.NetworkXData.NetworkxJsonEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NetworkxJsonEncoder</span></code></a>(*[, skipkeys, …])</p></td>
<td><p>When encoding JSON, sets are converted to lists.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#comptox_ai.graph.NetworkXData.add_edge" title="comptox_ai.graph.NetworkXData.add_edge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_edge</span></code></a>(self, edge)</p></td>
<td><p>Add one edge to the graph from a tuple.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#comptox_ai.graph.NetworkXData.add_edges" title="comptox_ai.graph.NetworkXData.add_edges"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_edges</span></code></a>(self, edges)</p></td>
<td><p>Add one or more edges to the graph from a list of tuples.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#comptox_ai.graph.NetworkXData.save_graph" title="comptox_ai.graph.NetworkXData.save_graph"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_graph</span></code></a>(self[, format])</p></td>
<td><p>Save NetworkX representation of ComptoxAI’s knowledge graph to disk in JSON “node-link” format.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 57%" />
<col style="width: 43%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>add_node</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>add_nodes</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="comptox_ai.graph.NetworkXData.NetworkxJsonEncoder">
<em class="property">class </em><code class="sig-name descname">NetworkxJsonEncoder</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">skipkeys=False</em>, <em class="sig-param">ensure_ascii=True</em>, <em class="sig-param">check_circular=True</em>, <em class="sig-param">allow_nan=True</em>, <em class="sig-param">sort_keys=False</em>, <em class="sig-param">indent=None</em>, <em class="sig-param">separators=None</em>, <em class="sig-param">default=None</em><span class="sig-paren">)</span><a class="headerlink" href="#comptox_ai.graph.NetworkXData.NetworkxJsonEncoder" title="Permalink to this definition">¶</a></dt>
<dd><p>When encoding JSON, sets are converted to lists.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#comptox_ai.graph.NetworkXData.NetworkxJsonEncoder.default" title="comptox_ai.graph.NetworkXData.NetworkxJsonEncoder.default"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default</span></code></a>(self, o)</p></td>
<td><p>Implement this method in a subclass such that it returns a serializable object for <code class="docutils literal notranslate"><span class="pre">o</span></code>, or calls the base implementation (to raise a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code>).</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">encode</span></code>(self, o)</p></td>
<td><p>Return a JSON string representation of a Python data structure.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">iterencode</span></code>(self, o[, _one_shot])</p></td>
<td><p>Encode the given object and yield each string representation as available.</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="comptox_ai.graph.NetworkXData.NetworkxJsonEncoder.default">
<code class="sig-name descname">default</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">o</em><span class="sig-paren">)</span><a class="headerlink" href="#comptox_ai.graph.NetworkXData.NetworkxJsonEncoder.default" title="Permalink to this definition">¶</a></dt>
<dd><p>Implement this method in a subclass such that it returns
a serializable object for <code class="docutils literal notranslate"><span class="pre">o</span></code>, or calls the base implementation
(to raise a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code>).</p>
<p>For example, to support arbitrary iterators, you could
implement default like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">iterable</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">o</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">iterable</span><span class="p">)</span>
    <span class="c1"># Let the base class default method raise the TypeError</span>
    <span class="k">return</span> <span class="n">JSONEncoder</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">o</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="method">
<dt id="comptox_ai.graph.NetworkXData.add_edge">
<code class="sig-name descname">add_edge</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">edge: tuple</em><span class="sig-paren">)</span><a class="headerlink" href="#comptox_ai.graph.NetworkXData.add_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Add one edge to the graph from a tuple.</p>
<p>The tuple should be formatted as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="p">{</span><span class="n">ID</span> <span class="n">of</span> <span class="n">u</span><span class="p">},</span>
    <span class="p">{</span><span class="n">relationship</span> <span class="nb">type</span><span class="p">},</span>
    <span class="p">{</span><span class="n">ID</span> <span class="n">of</span> <span class="n">v</span><span class="p">},</span>
    <span class="p">{</span><span class="nb">dict</span> <span class="n">of</span> <span class="n">edge</span> <span class="n">properties</span> <span class="p">(</span><span class="n">leave</span> <span class="n">empty</span> <span class="k">if</span> <span class="n">none</span><span class="p">)}</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>edge</strong><span class="classifier">tuple</span></dt><dd><p>Tuple containing edge data (see above for format specification).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="comptox_ai.graph.NetworkXData.add_edges">
<code class="sig-name descname">add_edges</code><span class="sig-paren">(</span><em class="sig-param">self, edges: List[tuple]</em><span class="sig-paren">)</span><a class="headerlink" href="#comptox_ai.graph.NetworkXData.add_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Add one or more edges to the graph from a list of tuples.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#comptox_ai.graph.NetworkXData.add_edge" title="comptox_ai.graph.NetworkXData.add_edge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_edge</span></code></a></dt><dd><p>Add a single edge from a tuple</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="comptox_ai.graph.NetworkXData.save_graph">
<code class="sig-name descname">save_graph</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">format=''</em><span class="sig-paren">)</span><a class="headerlink" href="#comptox_ai.graph.NetworkXData.save_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Save NetworkX representation of ComptoxAI’s knowledge graph to disk in
JSON “node-link” format.</p>
<p class="rubric">Notes</p>
<p>Users should not need to interact with these JSON files directly, but
for reference they should be formatted similarly to the following
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;directed&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;multigraph&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;graph&#39;</span><span class="p">:</span> <span class="p">{},</span>
    <span class="s1">&#39;nodes&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;ns0__xrefPubchemCID&#39;</span><span class="p">:</span> <span class="mi">71392231</span><span class="p">,</span>
            <span class="s1">&#39;ns0__xrefPubChemSID&#39;</span><span class="p">:</span> <span class="mi">316343675</span><span class="p">,</span>
            <span class="s1">&#39;ns0__inchi&#39;</span><span class="p">:</span> <span class="s1">&#39;InChI=1S/C8H12Cl2N4S2/c1-5(9)3-11-7(15)13-14-8(16)12-4-6(2)10/h1-4H2,(H2,11,13,15)(H2,12,14,16)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ns0__xrefCasRN&#39;</span><span class="p">:</span> <span class="s1">&#39;61784-89-2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;uri&#39;</span><span class="p">:</span> <span class="s1">&#39;http://jdr.bio/ontologies/comptox.owl#chem_n1n2bis2chloroprop2en1ylhydrazine12dicarbothioamide&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ns0__xrefDtxsid&#39;</span><span class="p">:</span> <span class="s1">&#39;DTXSID70814050&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ns0__inchiKey&#39;</span><span class="p">:</span> <span class="s1">&#39;UAZDGQNKXGUQPD-UHFFFAOYSA-N&#39;</span><span class="p">,</span>
            <span class="s1">&#39;LABELS&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ns0__Chemical&#39;</span><span class="p">,</span> <span class="s1">&#39;Resource&#39;</span><span class="p">,</span> <span class="s1">&#39;owl__NamedIndividual&#39;</span><span class="p">],</span>
            <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">},</span>
        <span class="o">...</span>
    <span class="p">],</span>
    <span class="s1">&#39;links&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;TYPE&#39;</span><span class="p">:</span> <span class="s1">&#39;ns0__keyEventTriggeredBy&#39;</span><span class="p">,</span>
            <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="mi">46954</span><span class="p">,</span>
            <span class="s1">&#39;target&#39;</span><span class="p">:</span> <span class="mi">47667</span>
        <span class="p">},</span>
        <span class="o">...</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Notice that <code class="docutils literal notranslate"><span class="pre">'graph'</span></code> is empty - the contents of the graph are
entirely specified in the <code class="docutils literal notranslate"><span class="pre">'nodes'</span></code> and <code class="docutils literal notranslate"><span class="pre">'links'</span></code> lists.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="comptox_ai.graph.GraphSAGEData">
<em class="property">class </em><code class="sig-prename descclassname">comptox_ai.graph.</code><code class="sig-name descname">GraphSAGEData</code><span class="sig-paren">(</span><em class="sig-param">graph: networkx.classes.digraph.DiGraph</em>, <em class="sig-param">node_map: Iterable = None</em>, <em class="sig-param">edge_map: Iterable = None</em>, <em class="sig-param">node_classes: List[str] = None</em>, <em class="sig-param">edge_classes: List[str] = None</em>, <em class="sig-param">node_features: Union[numpy.ndarray</em>, <em class="sig-param">pandas.core.frame.DataFrame] = None</em>, <em class="sig-param">edge_features: Union[numpy.ndarray</em>, <em class="sig-param">pandas.core.frame.DataFrame] = None</em><span class="sig-paren">)</span><a class="headerlink" href="#comptox_ai.graph.GraphSAGEData" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal representation of a GraphSAGE formatted graph/dataset.</p>
<p>This is essentially a NetworkX graph with a few extra data components
needed to run the GraphSAGE algorithms. It also provides a more flexible
way to work with node features, which are stored in a separate NumPy array
(which, unfortunately, isn’t natively compatible with heterogeneous
graphs).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>graph</strong><span class="classifier">nx.DiGraph</span></dt><dd><p>A NetworkX directed graph containing the nodes and edges that define
the topology of the ComptoxAI graph database. Nodes are identified by
the ID assigned to them by Neo4j.</p>
</dd>
<dt><strong>node_map</strong><span class="classifier">Iterable, default=None</span></dt><dd><p>An iterable where each element maps a Neo4j node id (int) to a
consecutively numbered index, used to map nodes to columns of the
(optional) matrix of node features. If None, a node map will be
generated from scratch.</p>
</dd>
<dt><strong>edge_map</strong><span class="classifier">Iterable, default=None</span></dt><dd><p>Currently not implemented (:TODO:)</p>
</dd>
<dt><strong>node_classes</strong><span class="classifier">list of str, default=None</span></dt><dd><p>Membership for classes to be used in supervised learning tasks. NOTE:
there is a semantic difference between the notion of ‘node classes’ in
an ontology / graph database (which specifies the semantic type(s) of
entities) versus in supervised learning (a target variable used to
learn a decision function), although they may be equivalent in some
settings.</p>
</dd>
<dt><strong>edge_classes</strong><span class="classifier">list of str, default=None</span></dt><dd><p>Currently not implemented (:TODO:)</p>
</dd>
<dt><strong>node_features</strong><span class="classifier">array-like, default=None</span></dt><dd><p>Array of node features.</p>
</dd>
<dt><strong>edge_features</strong><span class="classifier">array-like, default=None</span></dt><dd><p>Array of edge features.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>edges</strong></dt><dd></dd>
<dt><a class="reference internal" href="#comptox_ai.graph.GraphSAGEData.is_heterogeneous" title="comptox_ai.graph.GraphSAGEData.is_heterogeneous"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_heterogeneous</span></code></a></dt><dd><p>Return True if graph is heterogeneous, False otherwise.</p>
</dd>
<dt><strong>nodes</strong></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#comptox_ai.graph.GraphSAGEData.add_edge" title="comptox_ai.graph.GraphSAGEData.add_edge"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_edge</span></code></a>(self, edge, str, int])</p></td>
<td><p>Add an edge to GraphSAGE.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#comptox_ai.graph.GraphSAGEData.add_node" title="comptox_ai.graph.GraphSAGEData.add_node"><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_node</span></code></a>(self, node, \*\*kwargs)</p></td>
<td><p>Add a node to GraphSAGE.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 58%" />
<col style="width: 42%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>add_edges</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>add_nodes</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>save_graph</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="comptox_ai.graph.GraphSAGEData.add_edge">
<code class="sig-name descname">add_edge</code><span class="sig-paren">(</span><em class="sig-param">self, edge: Tuple[int, str, int]</em><span class="sig-paren">)</span><a class="headerlink" href="#comptox_ai.graph.GraphSAGEData.add_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an edge to GraphSAGE.</p>
<p>Edge format:
3-tuple with format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="p">{</span><span class="n">ID</span> <span class="n">of</span> <span class="n">u</span><span class="p">},</span>
    <span class="p">{</span><span class="n">relationship</span> <span class="n">label</span> <span class="p">(</span><span class="nb">str</span><span class="p">)},</span>
    <span class="p">{</span><span class="n">ID</span> <span class="n">of</span> <span class="n">v</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p>If the edge does not have a label, you should use the empty string
(‘’) as the second element of <cite>edge</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>edge</strong><span class="classifier">Tuple[int, str, int]</span></dt><dd><p>A tuple to add to the GraphSAGE dataset.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="comptox_ai.graph.GraphSAGEData.add_node">
<code class="sig-name descname">add_node</code><span class="sig-paren">(</span><em class="sig-param">self</em>, <em class="sig-param">node: int</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#comptox_ai.graph.GraphSAGEData.add_node" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a node to GraphSAGE.</p>
<p>A node is simply an ID corresponding to a node in the Neo4j graph.
Node features aren’t tied to the NetworkX digraph under GraphSAGE,
instead, they are stored in _node_features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>node</strong><span class="classifier">int</span></dt><dd><p>A Neo4j node id</p>
</dd>
<dt><strong>kwargs :</strong></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="comptox_ai.graph.GraphSAGEData.is_heterogeneous">
<em class="property">property </em><code class="sig-name descname">is_heterogeneous</code><a class="headerlink" href="#comptox_ai.graph.GraphSAGEData.is_heterogeneous" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if graph is heterogeneous, False otherwise.</p>
</dd></dl>

</dd></dl>

</div>



          <footer class="container-fluid">
  © 2020 by Joseph D. Romano and the Computational Genetics Lab (<a href="https://tldrlegal.com/license/mit-license" target="_blank">MIT License</a>)
</footer>
        </div>
      </div>
    </div>
  
</body>